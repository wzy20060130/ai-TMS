<script setup lang="ts">
import { ref, reactive } from 'vue'
import { Search, Refresh, Plus } from '@element-plus/icons-vue'
import { ElMessage } from 'element-plus'

// ç­›é€‰æ¡ä»¶
const filters = reactive({
  department: '',
  position: '',
  employeeStatus: '',
  keyword: '',
  dateRange: []
})

// éƒ¨é—¨é€‰é¡¹
const departmentOptions = [
  { label: 'å…¨éƒ¨', value: '' },
  { label: 'æ€»å…¬å¸', value: '1' },
  { label: 'åˆ†å…¬å¸', value: '2' },
  { label: 'è¿è¾“éƒ¨', value: '3' },
  { label: 'è´¢åŠ¡éƒ¨', value: '4' }
]

// èŒä½é€‰é¡¹
const positionOptions = [
  { label: 'å…¨éƒ¨', value: '' },
  { label: 'æ€»ç»ç†', value: '1' },
  { label: 'éƒ¨é—¨ç»ç†', value: '2' },
  { label: 'ä¸»ç®¡', value: '3' },
  { label: 'å‘˜å·¥', value: '4' }
]

// å‘˜å·¥çŠ¶æ€é€‰é¡¹
const employeeStatusOptions = [
  { label: 'å…¨éƒ¨', value: '' },
  { label: 'åœ¨èŒ', value: '1' },
  { label: 'ç¦»èŒ', value: '2' },
  { label: 'ä¼‘å‡', value: '3' }
]

// å‘˜å·¥åˆ—è¡¨
const employeeList = ref([
  {
    id: 1,
    employeeId: 'EMP0001',
    avatar: 'ğŸ‘¤',
    name: 'å¼ ä¼Ÿä¸­',
    department: 'æ€»å…¬å¸',
    departmentTag: 'success',
    position: 'æ€»ç»ç†',
    positionTag: 'danger',
    phone: '138****1234',
    joinDate: '2019-01-10',
    status: 'åœ¨èŒ',
    statusTag: 'success',
    actions: ['æŸ¥çœ‹', 'ç¼–è¾‘', 'åˆ é™¤']
  },
  {
    id: 2,
    employeeId: 'EMP0025',
    avatar: 'ğŸ‘¤',
    name: 'ææ˜',
    department: 'åˆ†å…¬å¸',
    departmentTag: 'primary',
    position: 'éƒ¨é—¨ç»ç†',
    positionTag: 'warning',
    phone: '138****4789',
    joinDate: '2019-05-10',
    status: 'åœ¨èŒ',
    statusTag: 'success',
    actions: ['æŸ¥çœ‹', 'ç¼–è¾‘', 'åˆ é™¤']
  },
  {
    id: 3,
    employeeId: 'EMP0048',
    avatar: 'ğŸ‘¤',
    name: 'ç‹å¼º',
    department: 'è¿è¾“éƒ¨é—¨',
    departmentTag: 'success',
    position: 'éƒ¨é—¨ç»ç†',
    positionTag: 'warning',
    phone: '139****5827',
    joinDate: '2020-01-15',
    status: 'åœ¨èŒ',
    statusTag: 'success',
    actions: ['æŸ¥çœ‹', 'ç¼–è¾‘', 'åˆ é™¤']
  },
  {
    id: 4,
    employeeId: 'EMP0052',
    avatar: 'ğŸ‘¤',
    name: 'èµµä¼Ÿ',
    department: 'å¸‚åœºè¥é”€éƒ¨',
    departmentTag: 'success',
    position: 'éƒ¨é—¨ç»ç†',
    positionTag: 'warning',
    phone: '137****8901',
    joinDate: '2020-03-08',
    status: 'åœ¨èŒ',
    statusTag: 'success',
    actions: ['æŸ¥çœ‹', 'ç¼–è¾‘', 'åˆ é™¤']
  },
  {
    id: 5,
    employeeId: 'EMP0076',
    avatar: 'ğŸ‘¤',
    name: 'å¼ ä¸½',
    department: 'è¿è¾“éƒ¨é—¨',
    departmentTag: 'success',
    position: 'è°ƒåº¦ä¸»ç®¡',
    positionTag: 'primary',
    phone: '136****2345',
    joinDate: '2020-05-20',
    status: 'ä¼‘å‡',
    statusTag: 'warning',
    actions: ['æŸ¥çœ‹', 'ç¼–è¾‘', 'åˆ é™¤']
  },
  {
    id: 6,
    employeeId: 'EMP0120',
    avatar: 'ğŸ‘¤',
    name: 'é™ˆæ˜',
    department: 'æŠ€æœ¯éƒ¨',
    departmentTag: 'success',
    position: 'æŠ€æœ¯æ€»ç›‘',
    positionTag: 'warning',
    phone: '135****5678',
    joinDate: '2020-04-01',
    status: 'åœ¨èŒ',
    statusTag: 'success',
    actions: ['æŸ¥çœ‹', 'ç¼–è¾‘', 'åˆ é™¤']
  },
  {
    id: 7,
    employeeId: 'EMP0156',
    avatar: 'ğŸ‘¤',
    name: 'åˆ˜èŠ³',
    department: 'è´¢åŠ¡éƒ¨',
    departmentTag: 'success',
    position: 'è´¢åŠ¡ç»ç†',
    positionTag: 'warning',
    phone: '134****9012',
    joinDate: '2020-06-15',
    status: 'ç¦»èŒ',
    statusTag: 'info',
    actions: ['æŸ¥çœ‹', 'ç¼–è¾‘', 'åˆ é™¤']
  },
  {
    id: 8,
    employeeId: 'EMP0048',
    avatar: 'ğŸ‘¤',
    name: 'ç‹å¼º',
    department: 'è¿è¾“éƒ¨é—¨',
    departmentTag: 'success',
    position: 'éƒ¨é—¨ç»ç†',
    positionTag: 'warning',
    phone: '139****5827',
    joinDate: '2020-01-15',
    status: 'åœ¨èŒ',
    statusTag: 'success',
    actions: ['æŸ¥çœ‹', 'ç¼–è¾‘', 'åˆ é™¤']
  }
])

// åˆ†é¡µ
const pagination = ref({
  currentPage: 1,
  pageSize: 20,
  total: 1248
})

// æœç´¢
const handleSearch = () => {
  console.log('æœç´¢', filters)
  ElMessage.success('æœç´¢å®Œæˆ')
}

// é‡ç½®
const handleReset = () => {
  Object.assign(filters, {
    department: '',
    position: '',
    employeeStatus: '',
    keyword: '',
    dateRange: []
  })
}

// æ–°å¢å‘˜å·¥
const handleAdd = () => {
  ElMessage.info('è·³è½¬åˆ°æ–°å¢å‘˜å·¥é¡µé¢')
}

// å¯¼å‡º
const handleExport = () => {
  ElMessage.success('æ­£åœ¨å¯¼å‡ºæ•°æ®...')
}

// æ‰“å°
const handlePrint = () => {
  ElMessage.success('æ­£åœ¨æ‰“å°...')
}

// æŸ¥çœ‹è¯¦æƒ…
const handleView = (row: any) => {
  console.log('æŸ¥çœ‹è¯¦æƒ…', row)
}

// ç¼–è¾‘
const handleEdit = (row: any) => {
  console.log('ç¼–è¾‘', row)
}

// åˆ é™¤
const handleDelete = (row: any) => {
  console.log('åˆ é™¤', row)
  ElMessage.warning('ç¡®è®¤åˆ é™¤è¯¥å‘˜å·¥ï¼Ÿ')
}

// åˆ†é¡µæ”¹å˜
const handlePageChange = (page: number) => {
  pagination.value.currentPage = page
}

const handleSizeChange = (size: number) => {
  pagination.value.pageSize = size
}
</script>

<template>
  <div class="employee-container">
    <!-- ç­›é€‰åŒºåŸŸ -->
    <div class="filter-card">
      <div class="filter-row">
        <div class="filter-item">
          <label class="filter-label">éƒ¨é—¨</label>
          <el-select v-model="filters.department" placeholder="å…¨éƒ¨" clearable>
            <el-option
              v-for="item in departmentOptions"
              :key="item.value"
              :label="item.label"
              :value="item.value"
            />
          </el-select>
        </div>

        <div class="filter-item">
          <label class="filter-label">èŒåŠ¡ç±»å‹/çº§åˆ«</label>
          <el-select v-model="filters.position" placeholder="å…¨éƒ¨" clearable>
            <el-option
              v-for="item in positionOptions"
              :key="item.value"
              :label="item.label"
              :value="item.value"
            />
          </el-select>
        </div>

        <div class="filter-item">
          <label class="filter-label">å·¥èµ„</label>
          <el-input v-model="filters.keyword" placeholder="è¯·è¾“å…¥" clearable />
        </div>

        <div class="filter-item">
          <label class="filter-label">å²—ä½</label>
          <el-input v-model="filters.keyword" placeholder="è¯·è¾“å…¥" clearable />
        </div>

        <div class="filter-item">
          <label class="filter-label">ç›®çš„åœ°</label>
          <el-select v-model="filters.employeeStatus" placeholder="å…¨éƒ¨" clearable>
            <el-option
              v-for="item in employeeStatusOptions"
              :key="item.value"
              :label="item.label"
              :value="item.value"
            />
          </el-select>
        </div>

        <div class="filter-item">
          <label class="filter-label">æ—¶é—´</label>
          <el-date-picker
            v-model="filters.dateRange"
            type="daterange"
            range-separator="è‡³"
            start-placeholder="å¼€å§‹æ—¥æœŸ"
            end-placeholder="ç»“æŸæ—¥æœŸ"
          />
        </div>

        <div class="filter-actions">
          <el-button type="primary" :icon="Search" @click="handleSearch">æœç´¢</el-button>
          <el-button :icon="Refresh" @click="handleReset">é‡ç½®</el-button>
        </div>
      </div>

      <div class="keyword-search">
        <el-input
          v-model="filters.keyword"
          placeholder="è¯·è¾“å…¥å‘˜å·¥å§“åã€å·¥å·ç­‰å…³é”®è¯æœç´¢"
          clearable
          style="width: 400px"
        >
          <template #prefix>
            <el-icon><Search /></el-icon>
          </template>
        </el-input>
      </div>
    </div>

    <!-- æ“ä½œæ  -->
    <div class="toolbar">
      <div class="toolbar-left">
        <span class="toolbar-title">å‘˜å·¥åˆ—è¡¨</span>
      </div>
      <div class="toolbar-right">
        <el-button type="primary" :icon="Plus" @click="handleAdd">æ–°å¢</el-button>
        <el-button @click="handleExport">å¯¼å‡º</el-button>
        <el-button @click="handlePrint">æ‰“å°</el-button>
        <el-button text>åˆ·æ–°</el-button>
      </div>
    </div>

    <!-- å‘˜å·¥åˆ—è¡¨ -->
    <div class="employee-table-card">
      <el-table :data="employeeList" stripe style="width: 100%">
        <el-table-column type="selection" width="50" />
        
        <el-table-column label="å‘˜å·¥å·¥å·" width="120" fixed>
          <template #default="{ row }">
            <div class="employee-id">{{ row.employeeId }}</div>
          </template>
        </el-table-column>

        <el-table-column label="å§“å" width="150">
          <template #default="{ row }">
            <div class="employee-info">
              <div class="employee-avatar">{{ row.avatar }}</div>
              <div class="employee-name">{{ row.name }}</div>
            </div>
          </template>
        </el-table-column>

        <el-table-column label="æ‰€å±éƒ¨é—¨" width="150">
          <template #default="{ row }">
            <el-tag :type="row.departmentTag" size="small">{{ row.department }}</el-tag>
          </template>
        </el-table-column>

        <el-table-column label="èŒä½" width="120">
          <template #default="{ row }">
            <el-tag :type="row.positionTag" size="small">{{ row.position }}</el-tag>
          </template>
        </el-table-column>

        <el-table-column label="è”ç³»ç”µè¯" width="150">
          <template #default="{ row }">
            <div class="phone">{{ row.phone }}</div>
          </template>
        </el-table-column>

        <el-table-column label="å…¥èŒæ—¶é—´" width="120">
          <template #default="{ row }">
            <div class="join-date">{{ row.joinDate }}</div>
          </template>
        </el-table-column>

        <el-table-column label="çŠ¶æ€" width="100">
          <template #default="{ row }">
            <el-tag :type="row.statusTag" size="small">{{ row.status }}</el-tag>
          </template>
        </el-table-column>

        <el-table-column label="æ“ä½œ" width="180" fixed="right">
          <template #default="{ row }">
            <el-button link type="primary" size="small" @click="handleView(row)">
              æŸ¥çœ‹
            </el-button>
            <el-button link type="primary" size="small" @click="handleEdit(row)">
              ç¼–è¾‘
            </el-button>
            <el-button link type="danger" size="small" @click="handleDelete(row)">
              åˆ é™¤
            </el-button>
          </template>
        </el-table-column>
      </el-table>

      <!-- åˆ†é¡µ -->
      <div class="pagination-wrapper">
        <el-pagination
          v-model:current-page="pagination.currentPage"
          v-model:page-size="pagination.pageSize"
          :page-sizes="[10, 20, 50, 100]"
          :total="pagination.total"
          layout="total, sizes, prev, pager, next, jumper"
          @size-change="handleSizeChange"
          @current-change="handlePageChange"
        />
      </div>
    </div>
  </div>
</template>

<style scoped>
.employee-container {
  padding: 0;
  background: #f8f9fa;
}

/* ç­›é€‰åŒºåŸŸ */
.filter-card {
  background: white;
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 16px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
  border: 1px solid #f0f0f0;
}

.filter-row {
  display: flex;
  flex-wrap: wrap;
  gap: 16px;
  align-items: flex-end;
  margin-bottom: 16px;
}

.filter-item {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.filter-label {
  font-size: 13px;
  color: #595959;
  font-weight: 500;
}

.filter-item :deep(.el-select),
.filter-item :deep(.el-input) {
  width: 160px;
}

.filter-item :deep(.el-date-editor) {
  width: 240px;
}

.filter-actions {
  display: flex;
  gap: 8px;
  margin-left: auto;
}

.keyword-search {
  padding-top: 16px;
  border-top: 1px solid #f0f0f0;
}

/* æ“ä½œæ  */
.toolbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}

.toolbar-left {
  display: flex;
  align-items: center;
}

.toolbar-title {
  font-size: 16px;
  font-weight: 600;
  color: #262626;
}

.toolbar-right {
  display: flex;
  gap: 8px;
}

/* å‘˜å·¥è¡¨æ ¼ */
.employee-table-card {
  background: white;
  border-radius: 8px;
  padding: 20px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
  border: 1px solid #f0f0f0;
}

.employee-id {
  font-size: 14px;
  font-weight: 600;
  color: #1890ff;
  cursor: pointer;
}

.employee-id:hover {
  text-decoration: underline;
}

.employee-info {
  display: flex;
  align-items: center;
  gap: 12px;
}

.employee-avatar {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: #e6f7ff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
}

.employee-name {
  font-size: 13px;
  color: #262626;
  font-weight: 500;
}

.phone {
  font-size: 13px;
  color: #595959;
}

.join-date {
  font-size: 13px;
  color: #595959;
}

/* åˆ†é¡µ */
.pagination-wrapper {
  margin-top: 20px;
  display: flex;
  justify-content: flex-end;
}

:deep(.el-table) {
  font-size: 13px;
}

:deep(.el-table th) {
  background: #fafafa;
  color: #595959;
  font-weight: 600;
}

:deep(.el-table td) {
  padding: 12px 0;
}
</style>


